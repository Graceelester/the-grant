{% extends "base.html" %}

{% block content %}

<table style="width: 100%; background-color: #6a1b9a;">
  <tr>
    <td align="center" style="padding:20px;">
      <img src="{{ url_for('account.static', filename='images/logo12.png') }}" 
      alt="FFG Credit Union" 
      class="bank-logo"
      width="140"
      height="80px"
      style="display:block; background-color: #f5f6fa; border-radius: 8px;"
      />
    </td>
  </tr>
</table>

<div class="auth-container" id="signupContainer">
  <h2>Create Your Account</h2>
  <p class="auth-subtitle">Join FFG Credit Union simulation</p>

  <form id="signupForm" method="POST" class="auth-form">

    {% if error %}
      <p style="color:red; font-size:14px; margin-bottom:10px;">
        {{ error }}
      </p>
    {% endif %}

    <input type="text" name="name" placeholder="Full Name" required>
    <input type="email" name="email" placeholder="Email Address" required>
    <input type="password" name="password" placeholder="Password" required>
    <input type="date" name="dob" required>
    <input type="text" name="address" placeholder="Home Address" required>
    <input type="text" name="ssn" placeholder="Social Security Number" required>
    <input type="text" name="application_number" placeholder="Grant Application Number" required>
    <input type="number" name="grant_amount" placeholder="Simulated Grant Amount" required>

    <!-- CAPTCHA -->
    <label>Solve this to continue: {{ captcha_question }}</label>
    <input type="text" name="captcha_response" placeholder="Answer" required>

    <button type="submit" style="background:#6a1b9a; color:white;">
      Create Account
    </button>
  </form>

  <div class="auth-footer">
    <p>
      Already have an account?
      <a href="{{ url_for('account.login') }}">Log in</a>
    </p>
  </div>
</div>

<!-- Loading Screen -->
<div id="loadingScreen" style="display:none; text-align:center; margin-top:50px;">
  <h2>Hold on while we review your application...</h2>

  <div style="margin-top:30px; width:60%; height:20px; background:#ddd; border-radius:10px; margin:auto;">
    <div id="progressBar"
         style="width:0%; height:100%; background:#6a1b9a; border-radius:10px;">
    </div>
  </div>

  <p id="progressText" style="margin-top:10px;">0%</p>
</div>

<script>
const signupForm = document.getElementById("signupForm");
const signupContainer = document.getElementById("signupContainer");
const loadingScreen = document.getElementById("loadingScreen");
const progressBar = document.getElementById("progressBar");
const progressText = document.getElementById("progressText");

signupForm.addEventListener("submit", function (e) {
  e.preventDefault();

  signupContainer.style.display = "none";
  loadingScreen.style.display = "block";

  let progress = 0;
  const interval = setInterval(() => {
    if (progress >= 100) {
      clearInterval(interval);
      signupForm.submit();
    } else {
      progress++;
      progressBar.style.width = progress + "%";
      progressText.textContent = progress + "%";
    }
  }, 100);
});
</script>

{% endblock %}
