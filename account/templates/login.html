{% extends "base.html" %}

{% block content %}

<!-- Top Logo Header -->
<table style="width: 100%; background-color: #6a1b9a;">
  <tr>
    <td align="center" style="padding:20px;">
      <img src="{{ url_for('account.static', filename='images/logo12.png') }}" 
      alt="FFG Credit Union" 
      class="bank-logo"
      width="140"
      height="80px"
      style="display:block; background-color: #f5f6fa; border-radius: 8px;"
      />
    </td>
  </tr>
</table>

<!-- Login Form -->
<div class="auth-container">
  <h2>Log In</h2>
  <p class="auth-subtitle">Access your FFG Credit Union account</p>

  <form method="POST" class="auth-form">
    <!-- Error message -->
    {% if error %}
    <p style="color: red; font-size: 14px; margin-bottom: 10px;">{{ error }}</p>
    {% endif %}

    <input type="email" name="email" placeholder="Email Address" required>
    <input type="password" name="password" placeholder="Password" required>
    
    <!-- CAPTCHA Section -->
    <label>Solve this to continue: {{ captcha_question }}</label>
    <input type="text" name="captcha_response" placeholder="Answer" required>
    
    <button type="submit">Log In</button>
  </form>

  <div class="auth-footer">
    <p style="margin: 8px 0;">
      Don't have an account? 
      <a href="{{ url_for('account.signup') }}">Sign up</a>
    </p>
    <p>
      <a href="{{ url_for('account.forgot_password') }}" style="color:#6a1b9a; text-decoration:underline;">
        Forgot Password?
      </a>
    </p>
  </div>
</div>

<!-- Loading overlay -->
<div id="loading-overlay" style="
  display:none;
  position: fixed;
  top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.6);
  z-index: 9999;
  justify-content:center;
  align-items:center;
  flex-direction: column;
  color:white;
  font-size:24px;
">
  <div class="spinner" style="
    border: 6px solid #f3f3f3;
    border-top: 6px solid #6a1b9a;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 1s linear infinite;
    margin-bottom: 20px;
  "></div>
  Logging in...
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>

<script>
const loginForm = document.querySelector('.auth-form');
const overlay = document.getElementById('loading-overlay');

loginForm.addEventListener('submit', function(e) {
  // Prevent actual form submission initially
  e.preventDefault();

  if (!document.querySelector('[name="captcha_response"]').value.trim()) {
    return;
  }

  overlay.style.display = 'flex';

  // Wait 6 seconds before submitting form
  setTimeout(() => {
    loginForm.submit();
  }, 6000);
});
</script>


{% endblock %}
